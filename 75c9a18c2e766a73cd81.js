/*! For license information please see 75c9a18c2e766a73cd81.js.LICENSE.txt */
(window.webpackJsonp=window.webpackJsonp||[]).push([[6],{286:function(e,t,s){},301:function(e,t,s){"use strict";var r=s(286);s.n(r).a},314:function(e,t,s){"use strict";s.r(t);s(0),s(22),s(12),s(2),s(36),s(37),s(29),s(1),s(79),s(23),s(3),s(221),s(17),s(4),s(222);var r=s(109),a=(s(213),s(78),s(60),s(50),s(85),s(238),s(44),s(178),s(38),s(57)),n=s(218),i={items:{en_us:"items",pt_br:"itens"},filter:{en_us:"filter",pt_br:"filtrar"},results:{en_us:"results",pt_br:"resultados"},sort:{en_us:"sort",pt_br:"ordenar"},searching_for:{en_us:"Searching for",pt_br:"Buscando por"},no_results_for:{en_us:"No results for",pt_br:"Nenhum resultado para"},brands:{en_us:"Brands",pt_br:"Marcas"},categories:{en_us:"Categories",pt_br:"Categorias"},refine_search:{en_us:"Refine search",pt_br:"Refinar busca"},close_filters:{en_us:"Close filters",pt_br:"Fechar filtros"},clear_filters:{en_us:"Clear filters",pt_br:"Limpar filtros"},relevance:{en_us:"Most relevant",pt_br:"Mais relevantes"},sales:{en_us:"Best sellers",pt_br:"Mais vendidos"},lowest_price:{en_us:"Lowest price",pt_br:"Menor preço"},highest_price:{en_us:"Highest price",pt_br:"Maior preço"},popular_products:{en_us:"Popular products",pt_br:"Produtos populares"},search_again:{en_us:"Search again",pt_br:"Buscar novamente"}},o={name:"EcSearchEngine",components:{EcProductCard:s(239).a},props:{lang:{type:String,default:a.$ecomConfig.get("lang")},storeId:{type:Number,default:a.$ecomConfig.get("store_id")},term:{type:String},page:{type:Number},pageSize:{type:Number},brands:{type:Array},categories:{type:Array},autoFixScore:{type:[Number,Boolean],default:.6},showFilters:{type:Boolean,default:!1},navbarId:String,prerenderedHTML:String},data:function(){return{ecomSearch:new n.a(this.storeId),currentPage:0,resultItems:[],fixedTerm:"",totalSearchResults:0,searching:!1,loadingMore:!1,searched:!1,emptyResult:!1,networkError:!1,filters:[],lastSelectedFilter:null,selectedOptions:{},sortOptions:[null,"sales","lowest_price","highest_price"],selectedSortOption:null}},computed:{hasSelectedOptions:function(){for(var e in this.selectedOptions)if(this.selectedOptions[e]&&this.selectedOptions[e].length)return!0;return!1},countedItems:function(){return(this.pageSize||24)*(this.currentPage-1)+this.resultItems.length}},methods:{dictionary:function(e,t){return t||(t=this&&this.lang||"en_us"),i[e]&&i[e][t]||""},fixTerm:function(){var e=this;if(this.term){var t=this.term,s=!0;if(this.ecomSearch.getTermSuggestions().forEach((function(r){var a=r.options,n=r.text;if(a.length){var i=a[0];i.score<e.autoFixScore&&(s=!1),t=t.replace(n,i.text)}})),s&&t!==this.term)return this.fixedTerm=t,this.ecomSearch.setSearchTerm(t).history.shift(),this.fetchItems(),!0}return!1},updateFilters:function(){var e=this,t=this.filters.find((function(t){return t.filter===e.lastSelectedFilter}));this.filters=t?[t]:[];var s=function(t,s,r){if(e.lastSelectedFilter!==t){e.filters.push({filter:t,filterObj:{show:e.filters.length<5,options:s},isSpec:r});var a=e.selectedOptions,n=a[t]?a[t].filter((function(e){return s.find((function(t){return t.key===e}))})):[];e.$set(e.selectedOptions,t,n)}};["Brands","Categories"].forEach((function(t){s(t,e.ecomSearch["get".concat(t)]())})),this.ecomSearch.getSpecs().forEach((function(e,t){var r=e.key,a=e.options;s(r,a,!0)}))},fetchItems:function(e,t){var s=this,r=this.ecomSearch;this.searching=!0,this.loadingMore=e>1||this.page>1,r.setPageNumber(e).fetch().then((function(){if(s.totalSearchResults=r.getTotalCount(),s.totalSearchResults||s.fixedTerm||!s.fixTerm()){if(e?(s.currentPage=e,s.resultItems=s.resultItems.concat(r.getItems())):(s.currentPage=1,s.resultItems=r.getItems()),!s.searched){if(!s.resultItems.length)return r.reset(),s.emptyResult=!0,s.fetchItems();setTimeout((function(){s.searched=!0}),10)}s.updateFilters(),s.networkError=!1}})).catch((function(r){console.error(r),t||r.response&&400===r.response.status?s.networkError=!0:s.fetchItems(e,!0)})).finally((function(){s.searching=s.loadingMore=!1}))},toggleFilters:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];this.$emit("update:showFilters",e)},filterLabel:function(e){var t=this.dictionary(e.toLowerCase());if(!t&&window._data&&Array.isArray(window._data.grids)){var s=window._data.grids.find((function(t){return t.grid_id===e}));if(s)return s.title||s.grid_id}return t||e},updateSearchFilter:function(e){var t=this.ecomSearch,s=this.selectedOptions[e];switch(s.length||(s=null),e){case"Brands":t.setBrandNames(s);break;case"Categories":t.setCategoryNames(s);break;default:t.setSpec(e,s)}},setFilterOption:function(e,t,s){var r=this.selectedOptions[e];if(s)this.lastSelectedFilter=e,r.push(t);else{var a=r.indexOf(t);a>-1&&r.splice(a,1),r.length||this.lastSelectedFilter!==e||(this.lastSelectedFilter=null)}this.updateSearchFilter(e),this.fetchItems()},clearFilters:function(){var e=this.selectedOptions;for(var t in e)e[t]&&(e[t]=[],this.updateSearchFilter(t));this.fetchItems()},setSortOrder:function(e){this.selectedSortOption=e,this.ecomSearch.setSortOrder(e),this.fetchItems()}},created:function(){var e=this.ecomSearch,t=this.term,s=this.page,r=this.pageSize,a=this.brands,n=this.categories;t&&e.setSearchTerm(t),Array.isArray(a)&&a.length&&e.setBrandNames(a),Array.isArray(n)&&n.length&&e.setCategoryNames(n),e.setPageSize(r||24),this.fetchItems(s||1)},mounted:function(){var e,t=this;if(this.navbarId){var s=this.$refs.nav;document.getElementById(this.navbarId).appendChild(s)}window.addEventListener("scroll",(function(){clearTimeout(e),!t.searching&&t.totalSearchResults>t.countedItems&&(e=setTimeout((function(){var e=t.$el,s=e.offsetTop,r=e.offsetHeight;window.pageYOffset+window.screen.height>=s+r&&t.fetchItems(t.currentPage+1)}),100))}))}},c=(s(301),s(173)),l=Object(c.a)(o,(function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("section",{staticClass:"ec-search-engine"},[s("nav",{ref:"nav"},[s("portal-target",{attrs:{name:"search-nav"}})],1),s("portal",{attrs:{to:"search-nav"}},[s("transition",{attrs:{"enter-active-class":"animated fadeInDown fast"}},[e.searched&&(e.searching||e.totalSearchResults>8||e.hasSelectedOptions)?s("div",{staticClass:"ec-search-engine__nav"},[e._t("nav",[s("div",{staticClass:"container"},[s("div",{staticClass:"row"},[s("div",{staticClass:"col-auto"},[s("div",{staticClass:"ec-search-engine__count"},[s("strong",[e._v(e._s(e.totalSearchResults))]),e._v(" "+e._s(e.dictionary("items"))+" "),e.searching?s("div",{staticClass:"spinner-grow ec-search-engine__spinner",attrs:{role:"status"}},[s("span",{staticClass:"sr-only"},[e._v("Loading...")])]):e._e()])]),s("div",{staticClass:"text-right col"},[e.hasSelectedOptions||e.filters.find((function(e){return e.filterObj.options.length}))?s("button",{staticClass:"btn ec-search-engine__toggle",attrs:{type:"button"},on:{click:function(t){return e.toggleFilters(!0)}}},[s("i",{staticClass:"fas fa-filter"}),e._v(" "+e._s(e.dictionary("filter"))+" "),s("span",{staticClass:"d-none d-md-inline"},[e._v(" "+e._s(e.dictionary("results"))+" ")])]):e._e(),s("b-dropdown",{attrs:{variant:"link","toggle-class":"ec-search-engine__toggle",right:"","no-caret":""},scopedSlots:e._u([{key:"button-content",fn:function(){return[s("i",{staticClass:"fas fa-sort"}),s("span",{staticClass:"d-none d-md-inline"},[e._v(" "+e._s(e.dictionary("sort"))+" ")])]},proxy:!0}],null,!1,2883328033)},e._l(e.sortOptions,(function(t,r){return s("b-dropdown-item",{key:"sort-"+r,attrs:{href:"#",active:e.selectedSortOption===t},on:{click:function(s){return s.preventDefault(),e.setSortOrder(t)}}},[e._v(" "+e._s(e.dictionary(t||"relevance"))+" ")])})),1)],1)])])],null,{totalSearchResults:e.totalSearchResults,toggleFilters:e.toggleFilters})],2):e._e()])],1),s("transition",{attrs:{"enter-active-class":"animated slideInRight","leave-active-class":"animated slideOutRight"}},[s("aside",{directives:[{name:"show",rawName:"v-show",value:e.showFilters,expression:"showFilters"}],staticClass:"ec-search-engine__sidebar card shadow"},[e._t("filters",[s("header",{staticClass:"card-header"},[e._v(" "+e._s(e.dictionary("refine_search"))+" "),s("button",{staticClass:"close",attrs:{type:"button","aria-label":e.dictionary("close_filters")},on:{click:function(t){return e.toggleFilters(!1)}}},[s("span",{attrs:{"aria-hidden":"true"}},[e._v("×")])])]),s("div",{staticClass:"card-body"},e._l(e.filters,(function(t){var r=t.filter,a=t.filterObj,n=t.isSpec;return a.options.length?s("div",{key:"filters-"+r,staticClass:"ec-search-engine__filter",class:"ec-search-engine__filter--"+r},[s("button",{staticClass:"btn ec-search-engine__filter__btn",attrs:{type:"button","aria-expanded":a.show?"true":"false","aria-controls":"collapse-"+r},on:{click:function(e){a.show=!a.show}}},[s("i",{staticClass:"fas fa-chevron-down"}),e._v(" "+e._s(e.filterLabel(r))+" ")]),s("b-collapse",{attrs:{id:"collapse-"+r},model:{value:a.show,callback:function(t){e.$set(a,"show",t)},expression:"filterObj.show"}},e._l(a.options,(function(t,a){return s("div",{key:r+"-"+a,staticClass:"custom-control custom-checkbox ec-search-engine__option"},[s("input",{staticClass:"custom-control-input",attrs:{type:"checkbox",id:r+"-"+a},domProps:{checked:e.selectedOptions[r].indexOf(t.key)>-1},on:{change:function(s){return e.setFilterOption(r,t.key,s.target.checked)}}}),s("label",{staticClass:"custom-control-label",attrs:{for:r+"-"+a}},[e._v(" "+e._s(t.key)+" "),n?e._e():s("small",[e._v(" ("+e._s(t.doc_count)+") ")])])])})),0)],1):e._e()})),0),s("footer",{staticClass:"card-footer"},[s("button",{staticClass:"btn btn-sm btn-block btn-outline-secondary",attrs:{type:"button"},on:{click:e.clearFilters}},[s("span",{staticClass:"mr-1"},[s("i",{staticClass:"fas fa-trash-alt"})]),e._v(" "+e._s(e.dictionary("clear_filters"))+" ")])])])],2)]),s("transition",{attrs:{"enter-active-class":"animated fadeIn slower"}},[e.searched?s("div",{staticClass:"ec-search-engine__results",style:{opacity:e.searching&&!e.loadingMore?.4:1}},[s("div",{staticClass:"ec-search-engine__info"},[e.term?[e.emptyResult?s("div",{staticClass:"ec-search-engine__no-results"},[s("div",{staticClass:"lead"},[e._v(" "+e._s(e.dictionary("no_results_for"))+" "),s("em",[e._v(e._s(e.term))])]),s("h1",[e._v(e._s(e.dictionary("popular_products")))])]):s("div",{staticClass:"ec-search-engine__terms"},[s("h1",[s("small",{staticClass:"d-none d-md-block"},[e._v(" "+e._s(e.dictionary("searching_for"))+": ")]),e._v(" "+e._s(e.fixedTerm||e.term)+" ")]),e.fixedTerm?s("em",{staticClass:"d-none d-lg-block"},[e._v(" "+e._s(e.dictionary("no_results_for"))+" "),s("s",[e._v(e._s(e.term))])]):e._e()])]:e._e(),s("transition",{attrs:{"enter-active-class":"animated fadeInDown","leave-active-class":"animated position-absolute fadeOutUp"}},[e.hasSelectedOptions?s("div",[s("button",{staticClass:"btn btn-sm btn-outline-secondary",attrs:{type:"button"},on:{click:e.clearFilters}},[s("span",{staticClass:"mr-1"},[s("i",{staticClass:"fas fa-trash-alt"})]),e._v(" "+e._s(e.dictionary("clear_filters"))+" ")]),e._l(e.selectedOptions,(function(t,r){return e._l(t,(function(t){return s("button",{staticClass:"btn m-1 btn-sm btn-light",attrs:{type:"button"},on:{click:function(s){return e.setFilterOption(r,t,!1)}}},[s("span",{staticClass:"mr-1"},[s("i",{staticClass:"fas fa-times"})]),e._v(" "+e._s(t)+" "),s("small",[e._v("\\ "+e._s(e.filterLabel(r)))])])}))}))],2):e._e()])],2),s("article",{staticClass:"ec-search-engine__retail"},[s("div",{staticClass:"row"},e._l(e.resultItems,(function(t){return s("div",{key:t._id,staticClass:"col-6 col-md-4 col-lg-3"},[e._t("product",[s("ec-product-card",{staticClass:"ec-search-engine__item",attrs:{lang:e.lang,storeId:e.storeId,product:t}})],null,{product:t})],2)})),0)]),s("transition",{attrs:{"enter-active-class":"animated fadeInDown","leave-active-class":"animated position-absolute fadeOutUp"}},[e.networkError?s("div",{staticClass:"alert alert-warning",attrs:{role:"alert"}},[s("h4",{staticClass:"alert-heading"},[e._v("Offline")]),"pt_br"===e.lang?[e._v(" Não foi possível buscar os produtos, por favor verifique sua conexão com a internet. ")]:[e._v(" Unable to fetch the products, please check your internet connection. ")],s("hr"),s("button",{staticClass:"btn btn-primary",attrs:{type:"button"},on:{click:function(t){return e.fetchItems(e.currentPage)}}},[s("i",{staticClass:"fas fa-search mr-1"}),e._v(" "+e._s(e.dictionary("search_again"))+" ")])],2):e._e()])],1):e._e()]),s("transition",{attrs:{"enter-active-class":"animated fadeInDown","leave-active-class":"animated fadeOutUp"}},[!e.searched||e.loadingMore?e._t("default",[s("div",{domProps:{innerHTML:e._s(e.prerenderedHTML)}})]):e._e()],2)],1)}),[],!1,null,null,null).exports;function u(e,t){var s=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),s.push.apply(s,r)}return s}function d(e){for(var t=1;t<arguments.length;t++){var s=null!=arguments[t]?arguments[t]:{};t%2?u(Object(s),!0).forEach((function(t){h(e,t,s[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(s)):u(Object(s)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(s,t))}))}return e}function h(e,t,s){return t in e?Object.defineProperty(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[t]=s,e}t.default=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"search-engine",s=document.getElementById(t);if(s){var a=window.storefront.$overlay,n=new URLSearchParams(window.location.search);new r.default({data:{showFilters:!1},render:function(r){var i=this;return r(l,{attrs:{id:t},props:d({},e.props,{term:n.get("term"),page:parseInt(n.get("page"),10),brands:n.getAll("brands"),categories:n.getAll("categories"),navbarId:"header",showFilters:i.showFilters,prerenderedHTML:s.outerHTML}),on:{"update:showFilters":function(e){i.showFilters=e,a&&(e?(a.show(),a.once("hide",(function(){i.showFilters=!1}))):a.hide())}}})}}).$mount(s)}}}}]);
//# sourceMappingURL=75c9a18c2e766a73cd81.js.map